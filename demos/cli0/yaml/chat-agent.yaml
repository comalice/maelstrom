name: chat-agent
version: 1.0
llm:  # Phase 1: Hierarchy fallback
  provider: "{{if .Env.LLM_PROVIDER}}{{.Env.LLM_PROVIDER}}{{else if .App.DefaultProvider}}{{.App.DefaultProvider}}{{else}}anthropic{{end}}"
  model: "{{if .Env.DEFAULT_MODEL}}{{.Env.DEFAULT_MODEL}}{{else}}{{.App.DefaultModel}}{{end}}"
  api_key: "{{.Env.LLM_API_KEY}}"
machine:
  id: root
  initial: idle
  context:
    history: []  # Persists chat log
  states:
    idle:
      on:
        MESSAGE:
          target: idle
          action: process_message
actions:
  process_message:
    type: llm  # Simple LLM (no tools/hire; add later)
    system: |
      You are {{.App.CompanyName}}'s chat agent in {{.App.Environment}} mode.
      Be helpful & conversational.
    prompt: |
      History: {{range .Context.history}}{{.user}}: {{.msg}} | {{.agent}}: {{.resp}}
{{end}}
      User: {{.Event.Data.message}}
      Respond:
    output_path: "$"